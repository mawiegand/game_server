<% 
@num_errors = 0

if (@only.length == 0 || @only.include?(:version)) && !@rules.version.nil? %>
  <h1>Game Rules @<%= "#{@rules.version[:major]}.#{@rules.version[:minor]}.#{@rules.version[:build]}"%></h1>
  <hr />
<% end %>

<% if (@only.length == 0 || @only.include?(:settlement_types)) && !@rules.settlement_types.nil? %>
  <h1>Settlement Types</h1>
  <% @rules.settlement_types.each do |settlement| %>
    <h2><%= settlement[:name][:en_US] %></h2>
    <table>
      <% settlement.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>

<% if (@only.length == 0 || @only.include?(:resource_types)) && !@rules.resource_types.nil? %>
  <h1>Resource Types</h1>
  <% @rules.resource_types.each do |resource| %>
    <h2><%= resource[:name][:en_US] %></h2>
    <table>
      <% resource.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>

<% if (@only.length == 0 || @only.include?(:character_ranks)) && !@rules.resource_types.nil? %>
  <h1>Character Ranks</h1>
  
  <h2>Mundane Ranks</h2>
  
  <p><b>Skillpoints per Rank:</b> <%= @rules.character_ranks[:skill_points_per_mundane_rank] %></p> 
  
  <% @rules.character_ranks[:mundane].each do |rank| %>
    <h3><%= rank[:name][:en_US] %></h3>
    <table>
      <% rank.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  
  <h2>Sacred Ranks</h2>

  <p><b>Skillpoints per Rank:</b> <%= @rules.character_ranks[:skill_points_per_sacred_rank] %></p> 
  
  
  <% @rules.character_ranks[:sacred].each do |rank| %>
    <h3><%= rank[:name][:en_US] %></h3>
    <table>
      <% rank.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>


<% if (@only.length == 0 || @only.include?(:queue_types)) && !@rules.queue_types.nil? %>
  <h1>Queue Types</h1>
  <% @rules.queue_types.each do |queue| %>
    <h2><%= queue[:symbolic_id] %></h2>
    <table>
      <% queue.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>


<% if (@only.length == 0 || @only.include?(:building_categories)) && !@rules.building_categories.nil? %>
  <h1>Building Categories</h1>
  <% @rules.building_categories.each do |building| %>
    <h2><%= building[:name][:en_US] %></h2>
    <table>
      <% building.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>

<% if (@only.length == 0 || @only.include?(:building_types)) && !@rules.building_types.nil? %>
  <h1>Building Types</h1>
  <% @rules.building_types.each do |building| %>
    <h2><%= building[:name][:en_US] %></h2>
    <table>
      <% building.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td>
            <%if key    == :costs                            
              @costs = value %>
              <%= render 'costs' %>
            <%elsif key == :production_time                  
              @production_time = value %>
              <%= render 'time' %>
            <%elsif key == :production                       
              @production = value %>
              <%= render 'productions' %>
            <%else%>
              <%= value %>
            <%end%>
          </td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>



<% if (@only.length == 0 || @only.include?(:unit_categories)) && !@rules.unit_categories.nil? %>
  <h1>Unit Categories</h1>
  <% @rules.unit_categories.each do |unit| %>
    <h2><%= unit[:name][:en_US] %></h2>
    <table>
      <% unit.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />
<% end %>


<% if (@only.length == 0 || @only.include?(:unit_types)) && !@rules.unit_types.nil? %>
  <h1>Units</h1>
  <% @rules.unit_types.each do |unit| %>
    <h2><%= unit[:name][:en_US] %></h2>
    <table>
      <% unit.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />

<% end %>



<% if (@only.length == 0 || @only.include?(:science_types)) && !@rules.science_types.nil? %>
  <h1>Sciences</h1>
  <% @rules.science_types.each do |science| %>
    <h2><%= science[:name][:en_US] %></h2>
    <table>
      <% science.each do |key, value| %>
        <tr>
          <td><b><%= key %></b></td>
          <td><%= value %></td>
        </tr>
      <% end %>
    </table>
  <% end %>
  <hr />

<% end %>

<%if @num_errors > 0 %>
 <h1 class="formula-error">You have <%= @num_errors %> errors in your formulas.</h1>
<%end%>
